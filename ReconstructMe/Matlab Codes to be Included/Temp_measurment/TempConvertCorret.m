function [Temp_map]=TempConvertCorret(ImT_i)

% m0 = -53.771;
% m1 = 0.0045575;
% m2 = -1.1621e-07;
% m3 = 1.692e-012;
% m4 = -9.9176e-18;
% 
% Temp_map_unc=m0 + m1.*Im_ir  + m2 .* Im_ir.^2 + m3 .* Im_ir.^3 + m4 .*Im_ir.^4; 

% c1=-1*10^-5;
% c2= 0.5*10^-6;
% c3=0.002;
% c4=-0.5*10^-5;
% c5=0.0025;
% c6=-0.5;

% y=1+100:256+100;
% x=1-60:320-60;

% y=-127:128;
% x=-159:160;

% y=1:256;
% x=1:320;
% 
% [X,Y]= meshgrid(x,y);
% 
% f= X.^2*c1 + X.*Y.*c2+ X.*c3 + Y.^2*c4+ Y.*c5 + c6;

Tobj= ImT_i(128,160);

y=1:256;
x=1:320;
[X,Y]= meshgrid(x,y);
e= Tobj*ones(size(ImT_i))- ImT_i;

%Linear model Poly22:
     %f(x,y) = p00 + p10*x + p01*y + p20*x^2 + p11*x*y + p02*y^2
%Coefficients (with 95% confidence bounds):
       p00 =     -0.1725  ;%(-0.1733, -0.1717)
       p10 =    0.001176  ;%(0.001168, 0.001183)
       p01 =    0.001505  ;%(0.001495, 0.001514)
       p20 = -3.169e-006  ;%(-3.189e-006, -3.149e-006)
       p11 = -6.019e-007  ;%(-6.246e-007, -5.793e-007)
       p02 = -4.929e-006  ;%(-4.96e-006, -4.897e-006)
       
f= p00 + X.*p10 + Y.*p01 + X.^2*p20 + X.*Y.*p11 + Y.^2*p02;

Temp_map= ImT_i+ f;
